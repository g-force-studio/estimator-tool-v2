Current focus:
- Move estimate generation to async worker with hybrid pricing retrieval.
- Surface missing price cases for low confidence/timeouts.

What's working:
- Estimate submit now enqueues job and triggers Edge worker.
- Hybrid search RPC defined (pgvector + trigram) for pricing candidates.
- Missing price is displayed in UI and PDF for low confidence/timeouts.

What's broken / pending:
- Migration + Edge Function deployment not yet applied.
- Queue drain depends on worker trigger or external scheduler.

Latest files touched:
- app/api/jobs/[id]/estimate/route.ts
- supabase/functions/estimate-worker/index.ts
- supabase/migrations/20260217_add_estimate_queue_and_pricing_search.sql
- app/jobs/[id]/page.tsx
- supabase/functions/generate-pdf/index.ts
- supabase/schema.sql
- NOTES.md
- code_state.txt

Commands to run locally:
- npm run build

Next 3 concrete steps:
1) Apply supabase/migrations/20260217_add_estimate_queue_and_pricing_search.sql in Supabase.
2) Deploy supabase/functions/estimate-worker and updated generate-pdf.
3) Re-test Submit → AI → PDF flow and confirm missing price display.
